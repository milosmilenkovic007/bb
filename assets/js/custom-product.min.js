document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".stripe-checkout-button").forEach((function(e){e.addEventListener("click",(function(){var t=e.closest(".paywall-button-container");if("stripe"===t.querySelector('select[name="payment-method"]').value){var n=t.dataset.productId,r=e.dataset.priceId,o=e.dataset.mode;console.log("Price ID:",r),console.log("Mode:",o),function(e,t,n){var r=Stripe("pk_test_51HaAwtK5jB6KWDXlgteNAsz7yn0xXiA1jluSEF96XKdiDJ7daT32leXRQjyRDhTKqx6R2tANyvbNmcF3u8rK63Y200SXAwp5e0"),o={lineItems:[{price:t,quantity:1}],successUrl:"https://martin.milos.live/omgangens-elva-marcus-danielson-och-max-fenger-tar-varsin-plats-i-omgangens-elva/",cancelUrl:"https://martin.milos.live",clientReferenceId:e};o.mode="subscription"===n?"subscription":"payment",r.redirectToCheckout(o).then((function(e){if(e.error)console.error(e.error.message);else{var t=e.paymentMethod.billing_details.email,n=e.paymentMethod.billing_details.name;(function(e,t){return fetch("/register_user.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,name:t})}).then((function(e){if(!e.ok)throw new Error("User registration failed");console.log("User registered successfully")}))})(r=t,n).then((function(){!function(e){var t=function(e){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+",n="",r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}(12);window.location.href="/wp-login.php?auto_login=true&username="+e+"&password="+t}(r)})).catch((function(e){console.error("Error registering user:",e)}))}var r}))}(n,r,o)}}))}))}));
//# sourceMappingURL=custom-product.min.js.map